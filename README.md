````markdown
# Coderr API

Welcome to the **Coderr API** – a modular, Django-based REST service built on the Django REST Framework (DRF). This project powers the backend for the Coderr web application, providing endpoints for offers management, orders, reviews, and user authentication and profile management.

---

## Table of Contents

1. [Project Structure](#project-structure)
2. [Key Features](#key-features)
3. [Technologies](#technologies)
4. [Installation](#installation)
5. [Starting the Server](#starting-the-server)
6. [Running Tests](#running-tests)
7. [API Overview](#api-overview)
    - [Users & Authentication](#users--authentication)
    - [Offers](#offers)
    - [Orders](#orders)
    - [Reviews](#reviews)
    - [User Profiles](#user-profiles)
    - [Statistical Endpoints](#statistical-endpoints)
8. [Serializers & Permissions](#serializers--permissions)
    - [Offers & OfferDetails](#offers--offerdetails)
    - [Orders & Reviews](#orders--reviews)
    - [User Profiles & Auth](#user-profiles--auth)
9. [Guest Logins in the Frontend](#guest-logins-in-the-frontend)
10. [License](#license)

---

## Project Structure

This API is split into several Django apps, each with its own models, serializers, views, and URL configurations. The most important apps are:

-   **`coderr_app`**: Central project settings and URL routing (`coderr_app/urls.py`).
-   **`user_auth_app`**: Manages user registration, login, and user profiles (customer or business).
-   **`offers_app`**: Manages the creation and maintenance of offers (Offers), including their associated details (OfferDetails).
-   **`orders_app`**: Handles customer orders (Orders) and reviews (Reviews).

Each app also contains its own `tests` folder covering models, views, serializers, and permission tests.

---

## Key Features

-   **User Authentication**

    -   Register new users (customer or business).
    -   Login with token-based authentication.
    -   Manage user profiles and roles.

-   **Offers Management**

    -   Create, retrieve, update, and delete offers.
    -   Each offer can contain three OfferDetails (basic, standard, premium).
    -   Automatic aggregation of minimum price and minimum delivery time across all OfferDetails.

-   **Orders Management**

    -   Place orders for OfferDetails as a customer.
    -   Track order status (e.g., `in_progress`, `completed`).
    -   Retrieve statistics on open and completed orders for a specific business user.

-   **Reviews**

    -   Customers can submit reviews for business users, limited to one review per business user.
    -   Filter, search, and sort reviews (e.g., by rating, last updated).
    -   Only the reviewer or an admin can modify or delete a review.

-   **API Schema & Documentation**

    -   OpenAPI 3.0 schema generated by **drf-spectacular**.
    -   Interactive documentation through **Swagger UI** and **Redoc**.

-   **Filtering, Ordering, and Pagination**
    -   Offers can be filtered by creator (business user), price, and delivery time.
    -   Supports ordering and pagination (6 items per page by default).

---

## Technologies

-   **Python 3.12 (recommended)**
-   **Django**
-   **Django REST Framework**
-   **drf-spectacular** (OpenAPI documentation)
-   **django-filters** (for filtering)

---

## Installation

1. **Clone the Repository**
    ```bash
    git clone <repository-url>
    cd Coderr_backend_v1.0.0
    ```
````

2. **Create and Activate a Virtual Environment**

    ```bash
    python -m venv env
    source env/bin/activate  # On Windows: env\Scripts\activate
    ```

3. **Install Dependencies**

    ```bash
    pip install -r requirements.txt
    ```

4. **Apply Migrations**

    ```bash
    python manage.py migrate
    ```

5. **(Optional) Create a Superuser**
    ```bash
    python manage.py createsuperuser
    ```

---

## Starting the Server

Run the development server with:

```bash
python manage.py runserver
```

The following endpoints will be available:

-   **API Root**  
    `http://127.0.0.1:8000/api/`

-   **Swagger UI**  
    `http://127.0.0.1:8000/api/schema/swagger-ui/`

-   **Redoc**  
    `http://127.0.0.1:8000/api/schema/redoc/`

---

## Running Tests

Execute the test suites using:

```bash
python manage.py test
```

All tests are located in each app’s `tests/` directory, covering functionalities such as models, serializers, views, and permissions.

---

## API Overview

Below is a summary of the most important endpoints. All paths are prefixed with `/api/...`.

### Users & Authentication

-   **`POST /api/registration/`**  
    Register a new user and receive an authentication token.

-   **`POST /api/login/`**  
    Authenticate an existing user and obtain an authentication token.

> **Protected Endpoints**  
> For any protected endpoint, include your token in the `Authorization` header:
>
> ```
> Authorization: Token <your_token_here>
> ```

### Offers

-   **`GET /api/offers/`**  
    Retrieves all offers, with filtering (by creator ID, price, delivery time), ordering, pagination, and full-text search.

-   **`POST /api/offers/`**  
    Creates a new offer (restricted to users with a business profile).

-   **`GET /api/offers/{offer_id}/`**  
    Retrieves details for a specific offer.

-   **`PUT/PATCH/DELETE /api/offers/{offer_id}/`**  
    Updates or deletes an existing offer. Permissions: only the owner or an admin can modify/delete.

-   **`GET /api/offerdetails/{id}/`**  
    Retrieves detailed information about a specific OfferDetail object.

### Orders

-   **`GET /api/orders/`**  
    Retrieves a list of orders. Customers see their own orders; business users see orders directed to them.

-   **`POST /api/orders/`**  
    Creates a new order from an OfferDetail (only allowed for `customer` profiles).

-   **`GET /api/orders/{order_id}/`**  
    Gets details for a specific order.

-   **`PATCH /api/orders/{order_id}/`**  
    Updates an order (e.g., changing status to `completed`). Only business users or admins.

-   **`DELETE /api/orders/{order_id}/`**  
    Deletes an order (only admins may do so).

### Reviews

-   **`GET /api/reviews/`**  
    Retrieves all reviews with support for filtering and ordering.

-   **`POST /api/reviews/`**  
    Creates a new review (only `customer`), restricted to one review per business user.

-   **`GET/PATCH/DELETE /api/reviews/{review_id}/`**  
    Retrieves, updates, or deletes a review. Only the review’s creator or an admin can modify/delete.

### User Profiles

-   **`GET /api/profile/{user_id}/`**  
    Retrieves a specific user’s profile.

-   **`PUT/PATCH/DELETE /api/profile/{user_id}/`**  
    Updates or deletes a user’s profile. Only the profile owner or an admin can modify/delete.

-   **`GET /api/profiles/business/`**  
    Lists all business profiles.

-   **`GET /api/profiles/customer/`**  
    Lists all customer profiles.

### Statistical Endpoints

-   **`GET /api/base-info/`**  
    Returns general platform statistics (number of reviews, average rating, number of business profiles, total offers).

-   **`GET /api/order-count/{business_user_id}/`**  
    Returns the count of `in_progress` orders for a specific business user.

-   **`GET /api/completed-order-count/{business_user_id}/`**  
    Returns the count of `completed` orders for a specific business user.

---

## Serializers & Permissions

### Offers & OfferDetails

-   **`OfferSerializer`**

    -   Accepts an array of `OfferDetail` entries and creates them along with the main Offer.
    -   Automatically calculates the `min_price` and `min_delivery_time`.
    -   Custom `to_representation` to tailor the response based on request method (GET vs. POST/PATCH).

-   **`OfferDetailSerializer`**

    -   Manages fields such as `price`, `delivery_time_in_days`, features, and the `offer_type`.

-   **Permissions**
    -   `IsProviderOrReadOnly`: Only business users can create new offers, while read-only access is public.
    -   `IsOwnerOrAdmin`: Only the offer owner or an admin can modify/delete.
    -   Combined in `OfferPermission` and `OfferDetailPermission` for both Offer and OfferDetail objects.

### Orders & Reviews

-   **`OrderSerializer`**

    -   Allows a customer to create an order by referencing an `offer_detail_id`.
    -   Populates order fields automatically from the associated OfferDetail.
    -   `CustomerPermission` ensures only customers can create new orders.

-   **`ReviewSerializer`**

    -   Restricts a customer to only one review per business user.
    -   `IsReviewerOrAdmin` ensures only the review owner or an admin can update/delete.

-   **Permissions**
    -   `CustomerPermission`: Only customers can create orders or reviews.
    -   `OrderPermission`: Allows only superusers to delete orders, and only business users to patch them.
    -   `IsReviewerOrAdmin`: For reviews, only creators or admins can modify them.

### User Profiles & Auth

-   **`RegistrationSerializer`**

    -   Handles user sign-ups, including verifying `password` and `repeated_password`.
    -   Creates a `UserProfile` of type `business` or `customer`.

-   **`UserProfileSerializer`**
    -   Manages profile data (location, description, etc.) and user info (email, names).
    -   Permission `ProfilePermission` restricts updates to the profile owner or admins.

---

## Guest Logins in the Frontend

From Coderr Frontend version 1.2.0 onward, the guest logins have been adjusted as follows:

```js
const GUEST_LOGINS = {
	customer: {
		username: "customeruser",
		password: "asdf1234",
	},
	business: {
		username: "businessuser",
		password: "asdf1234",
	},
};
```

---

## License

This code may be used solely for non-commercial educational purposes. Any commercial use, distribution, or modification requires the author's explicit written consent.

```

```
